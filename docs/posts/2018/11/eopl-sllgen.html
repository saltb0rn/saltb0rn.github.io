<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2021-09-30 ÖÜËÄ 13:08 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Sllgen Parser</title>
<meta name="generator" content="Org mode">
<meta name="author" content="saltb0rn">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"> -->
<meta name="referrer" content="same-origin">
<link rel="stylesheet" type="text/css" href="../../../css/stylesheet.css"/>
<link rel="icon" type="image/png" href="../../../img/icon.png" />
<!-- <script type="text/javascript" src="../../../js/live.js" defer></script> -->
<script src="../../../js/main.js" defer></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
    <nav>
        <a href="../../../"><img src="../../../img/logo.png" alt="Logo is on the way"/></a>
        <ul>
            <li><a accesskey="H" href="../../../"> Home </a></li>
            <li><a accesskey="T" href="../../../tags"> Tags </a></li>
            <li><a accesskey="A" href="../../../about"> About </a></li>
            <li><a accesskey="L" href="../../../todos"> Todos </a></li>
        </ul>
    </nav>
</div>
<div id="content">
<h1 class="title">The Sllgen Parser</h1>
<div class="abstract" id="org90c1c06">
<p>
<code>EOPL</code> æ˜¯ä¸€ä¸ªæœ¬å¥½ä¹¦,æ‰€ä»¥æˆ‘æƒ³å®Œæˆä¸Šé¢çš„ä¹ é¢˜.ä¸è¿‡ä¸»è¦å†…å®¹åªè®²äº†å¦‚ä½•å†™ç›´è¯‘å™¨, <code>parser</code> éƒ¨åˆ†åªæœ‰åœ¨é™„å½•é‡Œé¢è¯¦ç»†è¯´æ˜(å¯ä»¥ç†è§£,å› ä¸º <code>parser</code> ä¸æ˜¯ <code>interpreter</code> çš„ä¸€éƒ¨åˆ†).
</p>

<p>
<code>Sllgen</code> æ˜¯ <code>eopl</code> åº“æä¾›çš„ä¸€ä¸ªç”Ÿæˆå™¨,ç”¨æ¥ç”Ÿæˆ <code>lexer</code> å’Œ <code>parser</code>.ç”±äºå¹¶æ²¡æœ‰åœ¨æ­£æ–‡éƒ¨åˆ†å‡ºç°,é‚£ä¹ˆæˆ‘åªèƒ½å•ç‹¬äº†è§£ä¸€ä¸‹.
</p>

</div>

<div id="outline-container-org23859b6" class="outline-2">
<h2 id="org23859b6">å®ç°ä¸€é—¨è¯­è¨€çš„æµç¨‹/æ¨¡å¼</h2>
<div class="outline-text-2" id="text-org23859b6">
<p>
<code>EOPL</code> ä¸Šé¢è¯´è¿‡ä»¥å®ç°ä¸€é—¨ç›´è¯‘è¯­è¨€çš„æ•´ä¸ªæµç¨‹åˆ†ä¸¤æ­¥,ç¬¬ä¸€æ­¥å°±æ˜¯ <code>scanning</code> å’Œ <code>parsing</code>,ç¬¬äºŒæ­¥å°±æ˜¯ <code>interpreting</code> æˆ–è€… <code>compiling</code>.
</p>

<p>
ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ä¹Ÿæœ‰å¯ä»¥å«åšå‰ç«¯éƒ¨åˆ†å’Œåç«¯éƒ¨åˆ†.
</p>

<ul class="org-ul">
<li>å‰ç«¯(front-end)

<ol class="org-ol">
<li><code>Scanning</code>, æŠŠæºä»£ç åˆ†ä¸ºè¯(words),æ ‡ç‚¹ç¬¦å·(punctuation)ç­‰ç­‰,è¿™äº›å•å…ƒè¢«ç§°ä¸º <code>lexical items</code>, <code>lexmes</code> æˆ–è€…æœ€å¸¸å¬åˆ°çš„ <code>tokens</code> (ä¸‹æ–‡å°±ç”¨è¿™ä¸ªå«æ³•).</li>

<li><code>Parsing</code>, æŠŠ <code>scanning</code> å¾—åˆ°çš„ <code>tokens</code> åºåˆ—ç»„ç»‡æˆä¸€ä¸ªæœ‰å±‚æ¬¡çš„å¥æ³•ç»“æ„(<code>hierarchical syntactic structures</code>),è¿™ç§å¥æ³•ç»“æ„å°±æ˜¯æŠ½è±¡è¯­æ³•æ ‘(<code>abstract syntax tree</code>),ç®€ç§° <code>AST</code>,ä¸‹æ–‡ä¹Ÿç”¨è¿™ä¸ªå«æ³•.</li>
</ol></li>

<li><p>
åç«¯(back-end)
</p>

<p>
è¯­è¨€çš„ç±»å‹è¿è¡Œæ–¹å¼æœ‰ä¸¤ç§,ç›´è¯‘(interpreting)å’Œç¼–è¯‘(compiling),ä¹Ÿæœ‰çš„è¯­è¨€æ··åˆä¸¤ç§æ–¹å¼.
</p>

<ul class="org-ul">
<li><code>Interpreting</code>, è¿ç®— <code>parsing</code> å¾—åˆ°çš„ <code>AST</code>,å¾—å‡ºç»“æœ.è´Ÿè´£è¿™é¡¹å·¥ä½œçš„æ˜¯ <code>interpreter</code>,ä¸­æ–‡åå«ç›´è¯‘å™¨.</li>

<li><p>
<code>Compiling</code>, æŠŠ <code>AST</code> ç¿»è¯‘æˆåˆ«çš„è¯­è¨€,è¿™é—¨è¯­è¨€å¯èƒ½æ˜¯èƒ½å¤Ÿè¢«ç¡¬ä»¶ç›´è¯‘çš„æœºå™¨è¯­è¨€(machine language),ä¹Ÿå¯èƒ½æ˜¯ä¸€é—¨ç‰¹å®šç”¨é€”çš„ç›´è¯‘è¯­è¨€,è¿™é—¨è¯­è¨€çš„ç›´è¯‘å™¨å«åšè™šæ‹Ÿæœº(virtual machine).
</p>

<p>
è´Ÿè´£è¿™é¡¹å·¥ä½œçš„æ˜¯ <code>compiler</code>,ä¸­æ–‡åå«ç¼–è¯‘å™¨.ä¸€èˆ¬ <code>Compiler</code> å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†,
</p>

<ol class="org-ol">
<li><code>analyzer</code>,è´Ÿè´£æ¨æ–­å‡º(deduce)ç¨‹åºæœ‰ç”¨çš„ä¿¡æ¯.</li>

<li><code>translator</code>,è´Ÿè´£ç¿»è¯‘/ç¼–è¯‘å·¥ä½œ,å¯èƒ½ä¼šä½¿ç”¨åˆ° <code>analyzer</code> å¾—åˆ°çš„ä¿¡æ¯.</li>
</ol></li>
</ul></li>
</ul>

<p>
æˆ‘ä»¬æŠŠæƒ³è¦å®ç°çš„è¯­è¨€å«åš <code>source/defined language</code>,ç”¨äºå®ç°ç›´è¯‘å™¨/ç¼–è¯‘å™¨çš„è¯­è¨€å«åš <code>implementation/defining language</code>,å¯¹äºç¼–è¯‘è¯­è¨€æ¥è¯´,ç¿»è¯‘å¾—åˆ°è¯­è¨€å«åš <code>target language</code>.
</p>

<p>
æ‰€ä»¥æ•´ä¸ªæµç¨‹å°±æ˜¯:
</p>

<ol class="org-ol">
<li>å‰ç«¯å¤„ç† <code>source language</code> çš„ä»£ç ,</li>

<li>åç«¯å¤„ç†(ç›´è¯‘æˆ–è€…ç¼–è¯‘)å‰ç«¯å¾—åˆ°çš„ç»“æœ.</li>
</ol>
</div>
</div>


<div id="outline-container-orgf3d48f1" class="outline-2">
<h2 id="orgf3d48f1">ä»€ä¹ˆæ˜¯ lexer generator, parser generator, lexer å’Œ parser.</h2>
<div class="outline-text-2" id="text-orgf3d48f1">
<p>
<code>Parser generator</code> <b>æ¥å— grammar ä½œä¸ºè¾“å…¥ç„¶åè¾“å‡ºå¯ä»¥æ ¹æ® grammar è§£æå­—ç¬¦ä¸²æµçš„æºä»£ç </b>.
</p>

<p>
è¿™ä»½æºä»£ç å°±æ˜¯ <code>parser</code>,ä¸­æ–‡åè§£æå™¨.å®ç°è¯­è¨€æµç¨‹ä¸­çš„å‰ç«¯å°±æ˜¯ <code>parser</code> çš„å·¥ä½œ.
</p>

<p>
å…¶å®å‡†ç¡®æ¥è¯´, <code>parser</code> åªæ˜¯è´Ÿè´£ <code>parsing</code> çš„å·¥ä½œ,è¿˜æœ‰ä¸€ä¸ª <code>lexer</code>, ä¹Ÿå«åš <code>scanner</code>,è´Ÿè´£ <code>scanning</code> çš„å·¥ä½œ.
</p>

<p>
è¿™ä¸ªæ€ä¹ˆåˆ’åˆ†å®é™…ä¸Šé—®é¢˜ä¸å¤§,ä¸è¿‡æ¨èåˆ†å¼€çœ‹å¾…,çŸ¥é“çš„ç»†èŠ‚è¶Šå¤šå°±è¯æ˜è¶Šäº†è§£.
</p>

<p>
<code>Lexer generator</code> è´Ÿè´£æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ç¼–å†™æˆçš„è§„åˆ™ç”Ÿæˆ <code>lexer</code>,ä¸€èˆ¬ <code>parser generator</code> éƒ½åŒ…å«äº†å®ƒä»¬,æ¯”å¦‚è¿™é‡Œçš„ <code>sllgen</code>.
</p>

<p>
ç»å¸¸å¬åˆ°çš„ <code>lexer generator</code> æœ‰ <code>lex</code> å’Œ <code>flex</code>.
</p>

<p>
<code>Parser generator</code> æœ‰å¾ˆå¤š,æ¯”å¦‚ <code>Java</code> ç”¨çš„ <code>Antlr</code>, <code>Emacs Lisp</code> ç”¨çš„ <code>Bovine/Wisent</code>, <code>C/C++</code> ç”¨çš„ <code>GNU Bison</code> ç­‰ç­‰.
</p>

<p>
é™¤äº†é€šè¿‡ä½¿ç”¨çš„å¹³å°(è¯­è¨€)åˆ†ç±»ä»¥å¤–,å¯ä»¥é€šè¿‡è§£æç®—æ³•è¿›è¡Œåˆ’åˆ†,æ¯”å¦‚ <code>LL(1)</code>, <code>LR(1)</code>, <code>LALR(1)</code> ç­‰ç­‰.
</p>

<p>
ä¸ªäººæ¨èå¯ä»¥å­¦ä¹ ä¸€ä¸‹ <code>Bison</code> çš„ä½¿ç”¨,å› ä¸ºä¸å°‘å®ƒçš„ç§»æ¤,æ¯”å¦‚ä¸Šé¢çš„ <code>Wisent</code> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€.è¿™é‡Œæœ‰ä¸€ç¯‡<a href="http://alumni.cs.ucr.edu/~lgao/teaching/bison.html">ç®€å•å®Œæ•´çš„å®è·µ</a>å¯ä»¥é˜…è¯»ä¸€ä¸‹.
</p>

<p>
è§£æå™¨æ˜¯ä¸€ä¸ªæŒºå¤§çš„è¯é¢˜,å¦‚æœæƒ³äº†è§£æ›´å¤šè¿™ä¸€æ–¹é¢çš„å†…å®¹,å¯ä»¥çœ‹è¿™ä¸€ç¯‡ç»´åŸºæ–‡ç« : <code>Comparison of parser generators</code>.
</p>
</div>
</div>


<div id="outline-container-org4a184c2" class="outline-2">
<h2 id="org4a184c2">Scanning</h2>
<div class="outline-text-2" id="text-org4a184c2">
<p>
<code>tokens</code> ä¸€å®šè¦æ˜¯åŸå­,ä¹Ÿå°±æ˜¯ä¸å¯å†åˆ’åˆ†,è¿™éœ€è¦æ ¹æ®éƒ¨åˆ†çš„è¯­è¨€è§„èŒƒ(<code>the part of language specification</code>)æ¥åˆ’åˆ†,è¿™éƒ¨åˆ†çš„è¯­è¨€è§„èŒƒå«åšè¯æ³•è§„èŒƒ(<code>lexical specification</code>).
</p>

<p>
<b>å¦‚æœæ˜¯åœ¨BNFæˆ–è€…Grammarçš„æè¿°ä¸­,tokenså°±æ˜¯terminals</b>.
</p>

<p>
å…¸å‹çš„è¯æ³•è§„èŒƒæœ‰3ä¸ª:
</p>

<ol class="org-ol">
<li>ç©ºæ ¼åºåˆ—(<code>sequence of spaces</code>)å’Œæ¢è¡Œ(<code>newlines</code>)éƒ½æ˜¯ç­‰äºä¸€ä¸ªç©ºæ ¼.</li>

<li>æ³¨é‡Š(comment),ä»æŸä¸ªæ ‡è®°ç¬¦å·å¼€å§‹åˆ°æ¢è¡Œä¸ºæ­¢.</li>

<li>æ ‡è¯†ç¬¦(<code>identifier</code>),ä»¥å­—æ¯(letter)å¼€å¤´çš„å­—æ¯å’Œæ•°å­—ç»„æˆçš„åºåˆ—.</li>
</ol>


<div id="org254b30c" class="figure">
<p><img src="../../../files/the-task-of-the-scanner.png" alt="the-task-of-the-scanner.png">
</p>
</div>

<p>
<code>Scanner</code> å¯ä»¥äº¤ç»™ç”Ÿæˆå™¨æ¥ç”Ÿæˆ,ä¸ç”¨è‡ªå·±å†™,åªéœ€è¦åˆ—å‡ºè¯æ³•è§„èŒƒå°±å¯ä»¥ç”¨ç”Ÿæˆå™¨å®Œæˆå·¥ä½œ,ä¸€èˆ¬ç”¨æ­£åˆ™è¡¨è¾¾å¼å°±å¯ä»¥ç¼–å†™è§„èŒƒ.
</p>

<p>
ä¸è¿‡ä½¿ç”¨çš„ä¸æ˜¯ä¼ ç»Ÿçš„æ­£åˆ™è¡¨è¾¾å¼,æ˜¯ <code>Sllgen</code> é™„å½•ä¸­å®šä¹‰çš„æ­£åˆ™è¡¨è¾¾å¼,ä¸ªäººè§‰å¾—æŒºå¥½çš„,å°±å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹,è¿™é—¨æ­£åˆ™è¡¨è¾¾å¼çš„å®šä¹‰å¦‚ä¸‹,
</p>

<p>
<code>R :: = Character | R R | R âˆª R | R âˆ— | Â¬ Character</code>
</p>

<ul class="org-ul">
<li><code>c</code> åŒ¹é…ç”±ä¸€ä¸ª <code>c</code> å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸².</li>

<li><code>Â¬ c</code> åŒ¹é… <code>c</code> ä»¥å¤–çš„å­—ç¬¦</li>

<li><code>R S</code> åŒ¹é…å­—ç¬¦ä¸² <code>R</code> åé¢è·Ÿç€å­—ç¬¦ä¸² <code>S</code>,è¿™å«åš <code>concatenation</code>.</li>

<li><code>R âˆª R</code> åŒ¹é… <code>R</code> æˆ–è€… <code>S</code>,ä¹Ÿå¯ä»¥å†™ä½œ <code>R|S</code>,å«åš <code>alternation</code>.</li>

<li><code>R*</code> åŒ¹é…ç”± <code>n</code> (n &gt;= 0) ä¸ªå­—ç¬¦ä¸² <code>R</code> ç»„æˆçš„å­—ç¬¦ä¸².è¿™å«åš <code>R</code> çš„ <code>Kleene closure</code>.</li>
</ul>

<p>
å½“ <code>scanner</code> æ‰¾åˆ°ä¸€ä¸ª <code>token</code>,å®ƒå°±è¿”å›ä¸€ä¸ªåŒ…å«ä»¥ä¸‹æ•°æ®çš„æ•°æ®ç»“æ„:
</p>

<ul class="org-ul">
<li><code>class</code>, <code>token</code> çš„ç±»å‹.</li>

<li><code>datum</code>, <code>token</code> çš„æ•°æ®.</li>

<li><code>token</code> åœ¨è¾“å…¥æ–‡æœ¬/æºä»£ç ä¸­çš„ä½ç½®.</li>
</ul>

<p>
æˆ‘ç›´æ¥é‡‡ç”¨ <code>EOPL</code> ç¬¬ä¸‰ç« çš„ <code>LET</code> è¯­è¨€åšä¸ºä¾‹å­, <code>LET</code> çš„è¯æ³•è§„èŒƒå¦‚ä¸‹,
</p>

<pre class="example" id="org3932eba">
whitespace = (space|newline)(space|newline)*
comment = %(Â¬ newline)*
identifier = letter (letter|digit)*
number = (-|"")digit digit*
</pre>

<p>
ç°åœ¨ä¸º <code>scanner</code> å®šä¹‰è¿™ä¸ªè§„èŒƒ,
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">the-lexical-spec</span>
  '([whitespace (whitespace) skip]
    [comment (<span style="color: #CC9393;">"%"</span> (arbno (not #\newline))) skip]
    [identifier
     (letter (arbno (<span style="color: #F0DFAF; font-weight: bold;">or</span> letter digit <span style="color: #CC9393;">"_"</span> <span style="color: #CC9393;">"-"</span> <span style="color: #CC9393;">"?"</span>)))
     symbol]
    [number (digit (arbno digit)) number]
    [number (<span style="color: #CC9393;">"-"</span> digit (arbno digit)) number]))
</pre>
</div>

<p>
<code>Sllgen</code> çš„ <code>scanner</code> è§„èŒƒè¦æ»¡è¶³è¿™ä¸ª <code>BNF</code> è¯­æ³•,ä¹Ÿæ˜¯å’Œæ­£åˆ™è¡¨è¾¾å¼å·®ä¸å¤š,
</p>

<pre class="example" id="org81dee02">
Scanner-spec      :: = ({Regexp-and-action}âˆ—)
Regexp-and-action :: = (Name ({Regexp}âˆ—) Action)
Name              :: = Symbol
Regexp            :: = String | letter | digit | whitespace | any
                  :: = (not Character) | (or {Regexp}âˆ—)
                  :: = (arbno Regexp) | (concat {Regexp}âˆ—)
Action            :: = skip | symbol | number | string
</pre>

<p>
<code>Action</code> éƒ¨åˆ†æ˜¯æŒ‡åŒ¹é…çš„æ—¶å€™åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ“ä½œ, <code>skip</code> æ˜¯æŒ‡ä¸æ“ä½œå¹¶ä¸”ä¸æäº¤åŒ¹é… <code>token</code>.
</p>

<p>
<code>symbol, number, string</code> åˆ†åˆ«æ˜¯æŠŠåŒ¹é…ç»“æœè½¬æˆå¯¹åº” <code>Racket</code> çš„æ•°æ®ç±»å‹å¹¶ä¸”æäº¤ <code>token</code>.
</p>
</div>
</div>


<div id="outline-container-org7037e6a" class="outline-2">
<h2 id="org7037e6a">Parsing</h2>
<div class="outline-text-2" id="text-org7037e6a">
<p>
å¾—åˆ° <code>tokens</code> åå°±å¯ä»¥æŠŠå®ƒä»¬è½¬æˆ <code>AST</code>,è¿™ä¹ˆä¸€æ­¥è¦æ±‚çŸ¥é“è¯­è¨€çš„å¥æ³•ç»“æ„,ä¹Ÿè¢«å«åšä¸Šä¸‹æ–‡æ— å…³è¯­æ³•(<code>context-free grammar</code>),å¯ä»¥é€šè¿‡ <code>BNF</code> è¿›è¡Œå®šä¹‰.
</p>

<p>
<code>LET</code> çš„ <code>grammar</code> å®šä¹‰å¦‚ä¸‹,
</p>

<pre class="example" id="org3274e7a">
A-program  :: = Expression
Expression :: = Identifier
           :: = Number
           :: = - (Expression , Expression)
           :: = zero? (Expression)
           :: = if Expression then Expression else Expression
           :: = Identifier
           :: = let Identifier = Expression in Expression
</pre>

<p>
ç°åœ¨å®šä¹‰è¿™ä¸ªè¯­æ³•,
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">the-grammar</span>
  '([program (expression) a-program]

    [expression (number) const-exp]

    [expression
     (<span style="color: #CC9393;">"-"</span> <span style="color: #CC9393;">"("</span> expression <span style="color: #CC9393;">","</span> expression <span style="color: #CC9393;">")"</span>)
     diff-exp]

    [expression
     (<span style="color: #CC9393;">"zero?"</span> <span style="color: #CC9393;">"("</span> expression <span style="color: #CC9393;">")"</span>)
     zero?-exp]

    [expression
     (<span style="color: #CC9393;">"if"</span> expression <span style="color: #CC9393;">"then"</span> expression <span style="color: #CC9393;">"else"</span> expression)
     if-exp]

    [expression (identifier) var-exp]

    [expression
     (<span style="color: #CC9393;">"let"</span> identifier <span style="color: #CC9393;">"="</span> expression <span style="color: #CC9393;">"in"</span> expression)
     let-exp]))
</pre>
</div>

<p>
<code>Sllgen</code> çš„ <code>grammar</code> çš„å®šä¹‰è¦æ»¡è¶³å¦‚ä¸‹è¯­æ³•,
</p>

<pre class="example" id="orga9928db">
Grammar    :: = ({Production}âˆ—)
Production :: = (Lhs ({Rhs-item}âˆ—) Prod-name)
Lhs        :: = Symbol
Rhs-item   :: = Symbol | String
           :: = (arbno {Rhs-item}âˆ—)
           :: = (separated-list {Rhs-item}âˆ— String)
Prod-name  :: = Symbol
</pre>

<p>
åœ¨ <code>Sllgen</code> é‡Œé¢, åœ¨çŸ¥é“ <b>æŸ¥æ‰¾çš„å“ªä¸€ä¸ª nonterminal</b> å’Œ <b>å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªtoken</b> å, <code>grammar</code> è¦è®© <code>parser</code> åˆ¤æ–­å‡ºåœ¨ä½¿ç”¨å“ªä¸€ä¸ª <code>production</code>.è¿™ç§ <code>grammar</code> å°±æ˜¯ <code>LL(1)</code> è¯­æ³•.
</p>

<p>
(è¿™æ–¹é¢æˆ‘ä¸ªäººæ²¡æœ‰ä»€ä¹ˆäº†è§£,æœ‰é”™è¯¯çš„è¯å¯ä»¥æé†’æˆ–è€…ç­‰æˆ‘ä»¥åå‘ç°äº†ä¿®æ­£.)
</p>

<p>
è€Œ <code>Sllgen</code> å°±æ˜¯ Racket/Scheme çš„ä¸€ä¸ª <code>LL(1) parser generator</code>.
</p>

<p>
ä¸Šé¢çš„å®šä¹‰å¯ä»¥ç”¨äºä¹‹åç”Ÿæˆä»¥ä¸‹å®šä¹‰, <b>è¿™é‡Œç»™å®ƒä¸€ä¸ªå¤–å·,å®šä¹‰B</b> ,å°±æ˜¯æ ¹æ®è¿™äº›å®šä¹‰æ„æˆ <code>AST</code>,(æˆ‘æ›¾ç»æŒ‰ç…§ä¹¦ä¸Šçš„æ­¥éª¤ä½¿ç”¨ <code>define-datatype</code>,ç›´åˆ°æˆ‘çœ‹åˆ°äº†é…å¥—çš„æºä»£ç &#x2026;)
</p>

<div class="org-src-container">
<pre class="src src-scheme">(define-datatype program program?
  [a-program
   (exp1 expression?)])

(define-datatype expression expression?
  [const-exp
   (num number?)]
  [diff-exp
   (exp1 expression?)
   (exp2 expression?)]
  [zero?-exp
   (exp1 expression?)]
  [if-exp
   (exp1 expression?)
   (exp2 expression?)
   (exp3 expression?)]
  [var-exp
   (var identifier?)]
  [let-exp
   (var identifier?)
   (exp1 expression?)
   (body expression?)])
</pre>
</div>

<p>
<code>define-datatype</code> çš„å½¢å¼å¦‚ä¸‹,
</p>

<div class="org-src-container">
<pre class="src src-scheme">(define-datatype type-name type-predicate-name
  {(variant-name {(field-name predicate)}&#8727;)}+)
</pre>
</div>
</div>
</div>


<div id="outline-container-org4eb013c" class="outline-2">
<h2 id="org4eb013c">å‡†å¤‡å®Œæ¯•</h2>
<div class="outline-text-2" id="text-org4eb013c">
<p>
ä¸Šé¢çš„ä¸¤ä¸ªéƒ¨åˆ†å·²ç»å‡†å¤‡å¥½äº† <code>Sllgen</code> éœ€è¦çš„å‚æ•°äº†,å¯ä»¥å¼€å§‹æ­£å¼ä½¿ç”¨ <code>Sllgen</code> å®Œæˆè¯­è¨€å®ç°ä¸­ç¬¬ä¸€æ­¥çš„æ‰€æœ‰å·¥ä½œ.
</p>
</div>

<div id="outline-container-orgb1f1c4e" class="outline-3">
<h3 id="orgb1f1c4e">ç”Ÿæˆå®šä¹‰B</h3>
<div class="outline-text-3" id="text-orgb1f1c4e">
<div class="org-src-container">
<pre class="src src-scheme">(sllgen:make-define-datatypes the-lexical-spec the-grammar)
</pre>
</div>
</div>
</div>


<div id="outline-container-org8a2e898" class="outline-3">
<h3 id="org8a2e898">ç”Ÿæˆ Scanner</h3>
<div class="outline-text-3" id="text-org8a2e898">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">just-scan</span>
  (sllgen:make-string-scanner the-lexical-spec the-grammar))
</pre>
</div>
</div>
</div>


<div id="outline-container-org961457a" class="outline-3">
<h3 id="org961457a">ç”Ÿæˆ Parser</h3>
<div class="outline-text-3" id="text-org961457a">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">scan&amp;parse</span>
  (sllgen:make-string-parser the-lexical-spec the-grammar))
</pre>
</div>
</div>
</div>


<div id="outline-container-org61df89f" class="outline-3">
<h3 id="org61df89f">å®šä¹‰ REPL</h3>
<div class="outline-text-3" id="text-org61df89f">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">read-eval-print</span>
  (sllgen:make-rep-loop
   <span style="color: #CC9393;">"--&gt; "</span>
   (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (ast) (value-of-program ast))
   (sllgen:make-stream-parser the-lexical-spec the-grammar)))
</pre>
</div>

<p>
<code>value-of-program</code> ä¹Ÿå°±æ˜¯ç›´è¯‘å™¨çš„æ ¸å¿ƒéƒ¨åˆ†,è¯­è¨€å®ç°çš„ç¬¬äºŒéƒ¨åˆ†,è¿™é‡Œå°±ä¸å†™äº†,è‡ªå·±çœ‹ä¹¦.
</p>
</div>
</div>


<div id="outline-container-orgd9051df" class="outline-3">
<h3 id="orgd9051df">å®Œæ•´çš„ä¾‹å­</h3>
<div class="outline-text-3" id="text-orgd9051df">
<p>
<b>æ³¨æ„</b>: ç”±äºæ²¡æœ‰å®ç° <code>interpreter</code>,æ‰€ä»¥ <code>parsing</code> åå°±ç›´æ¥è¿”å› <code>AST</code>.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">lang.rkt</span>
#lang racket

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">grammar for the LET language</span>

(require eopl)

(provide (all-defined-out))

<span style="color: #5F7F5F;">;;;;;;;;;;;;;;;;;; </span><span style="color: #7F9F7F;">grammatical specification ;;;;;;;;;;;;;;;;;;</span>

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">the-lexical-spec</span>
  '([whitespace (whitespace) skip]
    [comment (<span style="color: #CC9393;">"%"</span> (arbno (not #\newline))) skip]
    [identifier
     (letter (arbno (<span style="color: #F0DFAF; font-weight: bold;">or</span> letter digit <span style="color: #CC9393;">"_"</span> <span style="color: #CC9393;">"-"</span> <span style="color: #CC9393;">"?"</span>)))
     symbol]
    [number (digit (arbno digit)) number]
    [number (<span style="color: #CC9393;">"-"</span> digit (arbno digit)) number]))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">the-grammar</span>
  '([program (expression) a-program]

    [expression (number) const-exp]

    [expression
     (<span style="color: #CC9393;">"-"</span> <span style="color: #CC9393;">"("</span> expression <span style="color: #CC9393;">","</span> expression <span style="color: #CC9393;">")"</span>)
     diff-exp]

    [expression
     (<span style="color: #CC9393;">"zero?"</span> <span style="color: #CC9393;">"("</span> expression <span style="color: #CC9393;">")"</span>)
     zero?-exp]

    [expression
     (<span style="color: #CC9393;">"if"</span> expression <span style="color: #CC9393;">"then"</span> expression <span style="color: #CC9393;">"else"</span> expression)
     if-exp]

    [expression (identifier) var-exp]

    [expression
     (<span style="color: #CC9393;">"let"</span> identifier <span style="color: #CC9393;">"="</span> expression <span style="color: #CC9393;">"in"</span> expression)
     let-exp]))


<span style="color: #5F7F5F;">;;;;;;;;;;;;;;;;;; </span><span style="color: #7F9F7F;">sllgen boilerplate ;;;;;;;;;;;;;;;;;;</span>

(sllgen:make-define-datatypes the-lexical-spec the-grammar)

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">show-the-datatypes</span>
  (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> () (sllgen:list-define-datatypes the-lexical-spec the-grammar)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">scan&amp;parse</span>
  (sllgen:make-string-parser the-lexical-spec the-grammar))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">just-scan</span>
  (sllgen:make-string-scanner the-lexical-spec the-grammar))

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">BUG bug here, do not use this function</span>
(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">read-eval-print</span>
  (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> ([interpreter (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (ast) ast)])
    ((sllgen:make-rep-loop
      <span style="color: #CC9393;">"--&gt; "</span>
      interpreter
      (sllgen:make-stream-parser the-lexical-spec the-grammar)))))
</pre>
</div>

<p>
å†æ¥ä¸€ä¸ªæ‰‹åŠ¨æµ‹è¯•,
</p>

<div class="org-src-container">
<pre class="src src-sh">racket@lang.rkt&gt; (read-eval-print)
--&gt; -(1,2)
<span style="color: #5F7F5F;">#</span><span style="color: #7F9F7F;">(struct:a-program #(struct:diff-exp #(struct:const-exp 1) #(struct:const-exp 2)))</span>
--&gt;
</pre>
</div>

<p>
è¿™ä¸ªå°±æ˜¯ç»è¿‡æ ¼å¼åŒ–çš„ <code>AST</code>,
</p>

<div class="org-src-container">
<pre class="src src-scheme">#(struct:a-program
  #(struct:diff-exp
    #(struct:const-exp 1)
    #(struct:const-exp 2)))
</pre>
</div>

<p>
å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ <code>syntax object</code>,å› æ­¤ <b>æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«å®ƒä»¬çš„ç»“æ„ä½“ç±»å‹,æ•°æ®ä»¥åŠä½ç½®</b>,åˆšå¥½æ»¡è¶³äº†ä¸Šé¢çš„è¦æ±‚.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: saltb0rn (<a href="mailto:asche34@outlook.com">asche34@outlook.com</a>)</p>
<p class="date">Date: 2018-11-03</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.4.6)</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
